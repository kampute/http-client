<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class HttpError401Handler | Kampute.HttpClient .NET Library </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class HttpError401Handler | Kampute.HttpClient .NET Library ">
      
      <meta name="description" content="Handles &#39;401 Unauthorized&#39; HTTP responses by attempting to re-authenticate and retry the request.">
      <link rel="icon" href="../ICON.png">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="">
      <meta name="docfx:tocrel" content="toc.html">
      
      
      <meta name="docfx:disablenewtab" content="true">
      
      <meta name="docfx:docurl" content="https://github.com/kampute/http-client/new/master/apiSpec/new?filename=Kampute_HttpClient_ErrorHandlers_HttpError401Handler.md&amp;value=---%0Auid%3A%20Kampute.HttpClient.ErrorHandlers.HttpError401Handler%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../ICON.png" alt="Kampute.HttpClient .NET Library">
            Kampute.HttpClient .NET Library
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler">



  <h1 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler" class="text-break">
Class HttpError401Handler  <a class="header-action link-secondary" title="View source" href="https://github.com/kampute/http-client/blob/master/src/Kampute.HttpClient/ErrorHandlers/HttpError401Handler.cs/#L45"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Kampute.html">Kampute</a>.<a class="xref" href="Kampute.HttpClient.html">HttpClient</a>.<a class="xref" href="Kampute.HttpClient.ErrorHandlers.html">ErrorHandlers</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Kampute.HttpClient.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Handles '401 Unauthorized' HTTP responses by attempting to re-authenticate and retry the request.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class HttpError401Handler : IHttpErrorHandler, IDisposable</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">HttpError401Handler</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="Kampute.HttpClient.Interfaces.IHttpErrorHandler.html">IHttpErrorHandler</a></div>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable">IDisposable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>




  <h2 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
The <a class="xref" href="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.html">HttpError401Handler</a> class is specifically designed to enhance instances of <a class="xref" href="Kampute.HttpClient.HttpRestClient.html">HttpRestClient</a> by providing a mechanism
to handle HTTP '401 Unauthorized' responses. When a request made by a <a class="xref" href="Kampute.HttpClient.HttpRestClient.html">HttpRestClient</a> instance receives a '401 Unauthorized' status code,
this indicates that the request was rejected due to insufficient or missing authentication credentials. The <a class="xref" href="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.html">HttpError401Handler</a> responds 
to such scenarios by initiating a re-authentication process using a delegate provided at instantiation, to obtain new authentication credentials.
</p>
<p>
The delegate provided to the constructor is tasked with obtaining new authentication credentials, which might involve interacting with an authentication 
server or prompting the user for credentials. Successful acquisition of new credentials leads to their application to the <a class="xref" href="Kampute.HttpClient.HttpRestClient.html">HttpRestClient</a>
instance, allowing the previously failed request to be retried with the updated authentication details.
</p>
<p>
When an authentication process is underway for a client, subsequent authentication requests from the client will not initiate new processes. Instead, they 
will await and utilize the outcome of the ongoing authentication. This approach guarantees that the authentication delegate is executed a single time for 
concurrent requests, ensuring both efficiency and thread safety.
</p>
<p>
A single instance of this error handler can be shared with multiple <a class="xref" href="Kampute.HttpClient.HttpRestClient.html">HttpRestClient</a> instances, enabling centralized management of authentication
challenges across various client instances that interact with different endpoints, if the <a class="xref" href="Kampute.HttpClient.HttpRestClient.html">HttpRestClient</a> instances share the same authentication
details. This enables a more efficient use of credentials and reduces the need for frequent re-authentications.
</p>
</div>


  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler__ctor_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.#ctor*"></a>

  <h3 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler__ctor_System_Func_Kampute_HttpClient_HttpResponseErrorContext_System_Threading_CancellationToken_System_Threading_Tasks_Task_System_Net_Http_Headers_AuthenticationHeaderValue___" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.#ctor(System.Func{Kampute.HttpClient.HttpResponseErrorContext,System.Threading.CancellationToken,System.Threading.Tasks.Task{System.Net.Http.Headers.AuthenticationHeaderValue}})">
  HttpError401Handler(Func&lt;HttpResponseErrorContext, CancellationToken, Task&lt;AuthenticationHeaderValue?&gt;&gt;)
  <a class="header-action link-secondary" title="View source" href="https://github.com/kampute/http-client/blob/master/src/Kampute.HttpClient/ErrorHandlers/HttpError401Handler.cs/#L75"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.html">HttpError401Handler</a> class.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public HttpError401Handler(Func&lt;HttpResponseErrorContext, CancellationToken, Task&lt;AuthenticationHeaderValue?&gt;&gt; asyncAuthenticator)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>asyncAuthenticator</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.func-3">Func</a>&lt;<a class="xref" href="Kampute.HttpClient.HttpResponseErrorContext.html">HttpResponseErrorContext</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken">CancellationToken</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.task-1">Task</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.http.headers.authenticationheadervalue">AuthenticationHeaderValue</a>&gt;&gt;</dt>
    <dd><p>The asynchronous delegate to be invoked to acquire new authorization details. The delegate receives the following parameters:</p>
<ul><li><span class="term">context</span>
    Provides context about the HTTP response indicating a '401 Unauthorized' error. It is encapsulated within
    an <a class="xref" href="Kampute.HttpClient.HttpResponseErrorContext.html">HttpResponseErrorContext</a> instance, allowing for an informed decision on authentication.
    </li><li><span class="term">cancellationToken</span>
    A <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken">CancellationToken</a> for canceling the operation.
    </li></ul>
The delegate should return a task resolving to an instance of <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.http.headers.authenticationheadervalue">AuthenticationHeaderValue</a> containing the  authorization details
necessary for subsequent requests if authentication can be successfully completed. If the authentication process fails, the delegate should
return <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.
</dd>
  </dl>









  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown if <code class="paramref">asyncAuthenticator</code> is <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</p>
</dd>
  </dl>



  <h2 class="section" id="methods">Methods
</h2>


  <a id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_AuthenticateAsync_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.AuthenticateAsync*"></a>

  <h3 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_AuthenticateAsync_Kampute_HttpClient_HttpResponseErrorContext_System_Threading_CancellationToken_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.AuthenticateAsync(Kampute.HttpClient.HttpResponseErrorContext,System.Threading.CancellationToken)">
  AuthenticateAsync(HttpResponseErrorContext, CancellationToken)
  <a class="header-action link-secondary" title="View source" href="https://github.com/kampute/http-client/blob/master/src/Kampute.HttpClient/ErrorHandlers/HttpError401Handler.cs/#L98"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Asynchronously authenticates an HTTP request that resulted in a '401 Unauthorized' response.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected virtual Task&lt;AuthenticationHeaderValue?&gt; AuthenticateAsync(HttpResponseErrorContext ctx, CancellationToken cancellationToken)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>ctx</code> <a class="xref" href="Kampute.HttpClient.HttpResponseErrorContext.html">HttpResponseErrorContext</a></dt>
    <dd><p>The error context for the HTTP response.</p>
</dd>
    <dt><code>cancellationToken</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken">CancellationToken</a></dt>
    <dd><p>A token for canceling the operation.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.task-1">Task</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.http.headers.authenticationheadervalue">AuthenticationHeaderValue</a>&gt;</dt>
    <dd><p>A task that resolves to an <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.http.headers.authenticationheadervalue">AuthenticationHeaderValue</a> if the client successfully acquires new authorization details; otherwise, <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Throws if <code class="paramref">ctx</code> is <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</p>
</dd>
  </dl>



  <a id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_CanHandle_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.CanHandle*"></a>

  <h3 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_CanHandle_System_Net_HttpStatusCode_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.CanHandle(System.Net.HttpStatusCode)">
  CanHandle(HttpStatusCode)
  <a class="header-action link-secondary" title="View source" href="https://github.com/kampute/http-client/blob/master/src/Kampute.HttpClient/ErrorHandlers/HttpError401Handler.cs/#L89"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Determines whether this handler can process the specified HTTP status code.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool CanHandle(HttpStatusCode statusCode)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>statusCode</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.httpstatuscode">HttpStatusCode</a></dt>
    <dd><p>The HTTP status code to evaluate.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">true</a> if the handler can process the status code; otherwise, <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">false</a>.</p>
</dd>
  </dl>







  <h4 class="section" id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_CanHandle_System_Net_HttpStatusCode__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This implementation specifically handles the HTTP '401 Unauthorized' status code.</p>
</div>




  <a id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_Dispose_" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.Dispose*"></a>

  <h3 id="Kampute_HttpClient_ErrorHandlers_HttpError401Handler_Dispose" data-uid="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.Dispose">
  Dispose()
  <a class="header-action link-secondary" title="View source" href="https://github.com/kampute/http-client/blob/master/src/Kampute.HttpClient/ErrorHandlers/HttpError401Handler.cs/#L135"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Releases the unmanaged resources used by the <a class="xref" href="Kampute.HttpClient.ErrorHandlers.HttpError401Handler.html">HttpError401Handler</a> and optionally disposes of the managed resources.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Dispose()</code></pre>
  </div>













  <h2 id="seealso">See Also</h2>
  <div class="seealso">
      <div><a class="xref" href="Kampute.HttpClient.HttpRestClient.html#Kampute_HttpClient_HttpRestClient_ErrorHandlers">ErrorHandlers</a></div>
  </div>

</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © 2024 Kampute
        </div>
      </div>
    </footer>
  </body>
</html>
